<!DOCTYPE html>
<html>

    <head>
        <meta name = "viewport" content="width = device-width, initial-scale = 1.0">
        <meta charset = "utf-8">        <title>timer</title>
            <link rel="stylesheet" href="timer.css">

    </head>
   
    <body>
        <h1 class = "title">Timer</h1>
        <div class = "inp">
            <input id = "inputh"  type = "number"  placeholder = "hour">
            <input id = "inputm" type = "number"  placeholder = "minute">
            <input id = "inputs" type = "number"  placeholder = "second">
        </div>

        <div class = "but">
            <button id = "start" onclick="start_counting();">Start</button>
            <button id = "pause" onclick="pause_counting();">Pause</button>
            <button id = "stop" onclick="stop_counting();">Stop</button>
        </div>
        <p id = "time" class = "time">current time:</p>

        <script>
            document.getElementById("pause").disabled = true;
            document.getElementById("stop") .disabled= true;

            var timer = 0, h = 0, m = 0, s = 0;

            function start_counting()
            {
                //➤ 意思是：「如果輸入是有效數字，就更新 h；否則保留原本的 h」。
                h = +document.getElementById("inputh").value || h;
                m = +document.getElementById("inputm").value || m;
                s = +document.getElementById("inputs").value || s;
           

                if( (h==0 && m==0 && s==0) || (h<0 || m<0 || s<0) )
                {
                    alert("The time entered is illegal!");
                    return;
                }
                //將值setInterval()賦給計時器變數timer。此方法接受兩個參數，
                // 第一個參數是一個函數，第二個參數是一個以毫秒為單位的時間。
                // 在本例中，我們指定計時器counting每 1000 毫秒（即 1 秒）執行一次函數。
                timer = setInterval(counting , 1000);
                //因為已經開始了 所以只能按pause stop = false(可按)
                document.getElementById("start").disabled = true;
                document.getElementById("pause").disabled = false;
                document.getElementById("stop").disabled = false;
                document.getElementById("inputh").disabled = true;
                document.getElementById("inputm").disabled = true;
                document.getElementById("inputs").disabled = true;
            }

            function pause_counting()
            {
                document.getElementById("start").disabled = false;
                document.getElementById("pause").disabled = true;
                document.getElementById("stop").disabled = false;
                document.getElementById("inputh").disabled = false;
                document.getElementById("inputm").disabled = false;
                document.getElementById("inputs").disabled = false;
                //並呼叫它clearInterval()來移除計時器並停止倒數計時。
                clearInterval(timer);
            }


            function end_counting()
            {
                document.getElementById("start").disabled = false;
                document.getElementById("pause").disabled = false;
                document.getElementById("stop") .disabled= true;
                document.getElementById("inputh") .disabled= false;
                document.getElementById("inputm") .disabled= false;
                document.getElementById("inputs") .disabled= false;

                clearInterval(timer);

                h = 0; 
                m = 0; 
                s = 0; 
                document.getElementById("time").innerHTML = "time stop";
            }
            // 如果秒是 0，且分也是 0，就進行h--
            // 如果秒是 0，且分也是 0，就進行h--
            // 如果 h 也等於 0，時間結束

            //假如m!=0 那就 m--
            //假如s!=0 那就 s--
            
            function counting()
            {

                if( s == 0 )
                {
                    if(m == 0)
                    {
                        if(h == 0)
                        {
                        // msh == 0
                        end_counting();
                        //告訴瀏覽器：「這個 fn（函式）先暫時放旁邊，等 DOM 更新完再執行」
                        /*setTimeout(function () {
                            alert("The time is up!"); }, 0);*/
                        setTimeout
                            (
                                ()=>alert("times up!"), 0
                            )
                             return;
                        }
                            else
                            {
                            //h !=0, m s ==0
                            h--; m= 59; s = 59;

                            }
                    }
                        else
                        {
                        // hm !=0 s==0
                        m--; s=59;
                        }
                   
                }else{

                    //h m s != 0;
                    s--;
                }
                
            document.getElementById("time").innerHTML = "current time: "+ h +"h" + m  +"m" +s + "s" ;

            //把值放到id 裡面
            document.getElementById("inputh").value = h;
            document.getElementById("inputm").value = m;
            document.getElementById("inputs").value = s;
            }



        </script>
    </body>
</html>